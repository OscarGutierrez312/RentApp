import Head from "next/head"
import Link from "next/link"
import {createClient} from "@supabase/supabase-js"
import {useRef} from "react"
import Router from "next/router";
import LayoutHome from "../components/layout_home"
import Carousel from "../components/carousel"

export default function Home({days}) {
  const opt = []
  const optCat = []

  const cat1 = useRef()
  days.map(function(i, idx){
    opt.push(<option key={idx} value={i[0]+"-"+i[2]}>{i[1]}</option>);
  })
  
  const setCat = async (event) =>{
    const val = event.target.value
    const val1 = val.split("-")
    const catOpt=[]
      if(val1[1] == 1){
          catOpt=[["6001","Familiar"], ["6002","Todoterreno"], ["6003","Deportivo"]]
      }
      if(val1[1] == 2 || val1[1] == 3){
          catOpt=[["6004","Ciudad"], ["6005","Deportiva"],["6006","Montaña"], ["6007","Profesional"]]
      }
      

      cat1.current.options[0] = new Option("Categoria", 0)
      catOpt.map(function(i, idx){
          cat1.current.options[idx+1] = new Option(i[1], i[0])
      })
  }

  const fields = async (event) => {
    event.preventDefault()
    console.log(event.target[0].value)
    console.log(event.target[1].value)
    console.log(event.target[2].value)
    console.log(event.target[3].value)
    Router.push("/Filter/"+event.target[0].value.split("-")[0]+"-"+event.target[1].value+"-"+event.target[2].value+"-"+event.target[3].value)
  }
  return (          
    <LayoutHome>
      <div className="z-auto m-2 divide-y-4 divide-black-200 divide-solid">
        <Head>
            <title>EasyCar</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/favicon.ico" />
        </Head> 
        <div className="text-center  p-20 px-6 mb-9 ">
            <h1 className="text-5xl font-bold font-sans 
            sm:text-6xl
            md:text-7xl
            lg:text-8xl
            mt-0 mb-6 text-[#98c8eb] hover:text-[#4a65eb] transition duration-150 ease-in-out">
                Bienvenido a EasyCar</h1>
            <h3 className="text-2xl font-thin mb-8 italic">
                Pide o Arrienda cualquiera de 
            los tipos de vehiculos disponibles</h3>
        </div>
        <h1 className="px-40 pt-10 text-4xl text-yellow-700 hover:scale-105 transition duration-150 ease-in-out">Busca un Vehículo por tu Marca Favorita,
         Elige la Categoria que más se ajuste a lo que necesitas ó Selecciona un Rango de Precio</h1>    
        <div className="block p-6 rounded-lg shadow-lg bg-white max-w-2xl ml-[30%] mt-28 mb-28">
          
          <form onSubmit={fields}>
              <div className="grid grid-cols-4 gap-4">
                <div className="flex justify-center">
                    <div className="mb-3 xl:w-full">
                        <select className="form-select appearance-none block w-full px-3 py-1.5 text-base font-normal
                        text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded
                        transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" 
                        aria-label="Default select example"
                        defaultValue={0}
                        onChange={setCat}
                        >                 
                        <option value={0}>Marca</option>         
                        {opt.map(function(i){
                          return(i)
                        })}
                        </select>
                    </div>
                    
                </div>
                <div className="flex justify-center">
                    <div className="mb-3 xl:w-96">
                        <select className="form-select appearance-none block w-full px-3 py-1.5 text-base font-normal
                        text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded
                        transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" 
                        aria-label="Default select example"
                        defaultValue={0}
                        ref={cat1}
                        >                 
                        <option value={0}>Categoria</option>         
                        {optCat.map(function(i){
                          return(i)
                        })}
                        </select>
                    </div>
                    
                </div>
                <div className="flex justify-center">
                    <div className="ml-10 xl:w-96">
                        <select className="form-select appearance-none block w-48 mx-3 py-1.5 text-base font-normal
                        text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded
                        transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" 
                        aria-label="Default select example"
                        defaultValue={0}
                        >       
                        <option value={0}>Rango de Precio</option>          
                        <option value={1}>Menor a</option>   
                        <option value={2}>Mayor a</option>       
                        
                        </select>
                    </div>
                    
                </div>
                <div className="flex justify-center">
                    <div className="ml-10 xl:w-80">
                        <input className="form-input appearance-none block w-24 mx-3 py-1.5 text-base font-normal
                        text-gray-700 bg-white bg-clip-padding bg-no-repeat border border-solid border-gray-300 rounded
                        transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" 
                        aria-label="Default select example"
                        placeholder="Precio"
                        type="number"
                        min={0}
                        defaultValue={0}
                        ></input>
                    </div>
                    
                </div>
              
              </div>                                                 
              <button type="submit" className="w-full px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md
                  hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg
                  transition duration-150 ease-in-out">Buscar</button>
              
                      
          </form>
        </div>
        <Carousel/>
        <div className="grid grid-cols-2 pr-52 pl-52 pb-52">
          <Link href="/info/manual">
              <div className="col-span-2">
                <h2 className="text-7xl italic text-[#e8b984]">Manual de Solicitud</h2>
                
                <div className="flex justify-center m-10 cursor-pointer">
                    <div className="flex flex-col min-w-fit min-h-fit max-w-lg md:flex-row md:max-w-xl rounded-lg bg-white shadow-lg ring-2 ring-[#d3f5e6] hover:scale-110 transition duration-150 ease-in-out">
                      <img className=" w-full h-96 md:h-auto object-cover md:w-48 md:rounded-none md:rounded-l-lg" src="/images/manual.jpg" alt="img" />
                      <div className="p-6 flex flex-col justify-start">
                        <h5 className="text-gray-900 text-xl font-medium mb-2">Paso a Paso</h5>
                        <p className="text-gray-700 text-base mb-4">
                          Entra, enterate de como solicitar un vehículo para tu dia a dia o cualquier otro momento que permita transportarte a ti 
                          y a tu familia o amigos con comodidad y tranquilidad a un comodo precio.
                        </p>
                        <p className="text-gray-600 text-xs"> </p>
                      </div>
                    </div>
                  
                </div>
              </div>       
          </Link>

          <Link href="/info/seguros">
            <div className="col-span-2">
              <h2 className="text-7xl italic text-[#e8b984]">Vehículos Asegurados</h2>
              <div className="flex justify-center m-10 cursor-pointer">
                <div className="flex flex-col min-w-fit min-h-fit max-w-lg md:flex-row md:max-w-xl rounded-lg bg-white shadow-lg ring-2 ring-[#d3f5e6] hover:scale-110 transition duration-150 ease-in-out">
                  <img className=" w-full h-96 md:h-auto object-cover md:w-48 md:rounded-none md:rounded-l-lg" src="/images/seguro.jpeg" alt="img"/>
                  <div className="p-6 flex flex-col justify-start">
                    <h5 className="text-gray-900 text-xl font-medium mb-2">Viaja Seguro</h5>
                    <p className="text-gray-700 text-base mb-4">
                      Nuestros Vehículos cuentan con un seguro contra robos y accidentes, que establecen un estandar de seguridad para nuestros vehículos y usuarios, por esto 
                      y mucho mas puedes viajar tranquilo con los vehículos que se ofrecen en la plataforma.
                    </p>
                    <p className="text-gray-600 text-xs"> Aplica Condiciones y Restricciones</p>
                  </div>
                </div>
              </div>
            </div>
          </Link>

          <Link href="/User/comments">
            <div className="col-span-2">
              <h2 className="text-7xl italic text-[#e8b984]">Comentarios, Sugerencias o Reporte de Errores</h2>
              <div className="flex justify-center m-10 cursor-pointer">
                <div className="flex flex-col min-w-fit min-h-fit max-w-lg md:flex-row md:max-w-xl rounded-lg bg-white shadow-lg ring-2 ring-[#d3f5e6] hover:scale-110 transition duration-150 ease-in-out">
                  <img className=" w-full h-96 md:h-auto object-cover md:w-48 md:rounded-none md:rounded-l-lg" src="/images/seguro.jpeg" alt="img"/>
                  <div className="p-6 flex flex-col justify-start">
                    <h5 className="text-gray-900 text-xl font-medium mb-2">Deja tu Comentario</h5>
                    <p className="text-gray-700 text-base mb-4">
                      Escribe aqui tus comentarios, sugerencias, peticiones, quejas, reclamos o reporta un error que hubieses presentado en el proceso de algunos de
                      los servicios de nuetra plataforma
                    </p>
                    <p className="text-gray-600 text-xs">Sera de gran ayuda!</p>
                  </div>
                </div>
              </div>
            </div>
          </Link>
               
        </div>       
      </div>
    </LayoutHome>
  )

}
export async function getServerSideProps({params}){
    
  const supabaseAdmin = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL,
    process.env.SUPABASE_SERVICE_ROLE_KEY
  );

  const days = []

  const marcas = await supabaseAdmin
  .from("Marca")
  .select('*');
  
  const marc = marcas.data

  marc.map(function(i, idx){
    days.push([i.id_Marca, i.desc_Marca, i.id_Tipo_Vehiculo]);
  })

  return{
      props:{
          
          days
      }
  }
  
}
